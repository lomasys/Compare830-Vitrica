{
  "gitSyncId": "69907fc86e9d3f3f72205f7c_a31b48a9-559e-411b-a3c9-9de5f5b49f0a",
  "id": "Comparador830_qDiffsInsert",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "insert into file_compare_diffs (\n  run_id,\n  period_key,\n  year,\n  month,\n  iso_week,\n  year_week,\n  part_number,\n  change_type,\n  prev_value,\n  curr_value,\n  diff_value,\n  row_payload\n)\nselect\n  {{ this.params.run_id }}::uuid,\n  {{ this.params.period_key || moment().format(\"YYYY-MM\") }},\n  {{ this.params.year || moment().year() }},\n  {{ this.params.month || (moment().month() + 1) }},\n  {{ this.params.iso_week || moment().isoWeek() }},\n  {{ this.params.year_week || moment().format(\"GGGG-[W]WW\") }},\n  d->>'numeroParte',\n  d->>'tipo',\n  nullif(d->>'valorAnterior','')::numeric,\n  nullif(d->>'valorActual','')::numeric,\n  nullif(d->>'diferencia','')::numeric,\n  d\nfrom jsonb_array_elements(\n  {{ JSON.stringify(this.params.diferencias || []) }}::jsonb\n) d\nwhere coalesce(d->>'numeroParte','') <> ''  -- opcional: evita rows sin parte\nreturning id, run_id, part_number, change_type;\n\n\n\n\n\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Control Tower",
      "isAutoGenerated": false,
      "name": "Control Tower",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "qDiffsInsert",
    "pageId": "Comparador830",
    "runBehaviour": "MANUAL",
    "userSetOnLoad": false
  }
}